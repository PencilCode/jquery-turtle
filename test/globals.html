<script src="lib/qunit.js"></script>
<link href="lib/qunit.css" rel="stylesheet">
<script src="lib/jquery.js"></script>
<script>
var _global_leaks_ = (function _added_() {
  var before = {};
  for (var n in window) { before[n] = true; }
  return function leaks() {
    var after = {}, result = [];
    for (var n in window) { after[n] = true; }
    for (n in before) { delete after[n]; }
    for (n in after) { result.push(n); }
    if (result.length == 1 && /^jQuery.*\./.test(result)) { result.pop(); }
    return result;
  }
})();
</script>
<script src="../jquery-turtle.js"></script>
<body>
<div id="qunit"></div>
<script>
module("Test of globals.");
asyncTest("Verify no unexpected globals are introduced.", function() {
  ok(_global_leaks_().length == 0, _global_leaks_());
  eval($.turtle({ids:false}));
  var expected = [
    "lastmouse",
    "lastclick",
    "lastdblclick",
    "lastmouseup",
    "lastmousedown",
    "lastmousemove",
    "see",
    "debug",
    "log",
    "printpage",
    "interrupt",
    "cs",
    "cg",
    "ct",
    "canvas",
    "copy",
    "sizexy",
    "tick",
    "forever",
    "speed",
    "say",
    "play",
    "tone",
    "silence",
    "sync",
    "remove",
    "done",
    "load",
    "save",
    "append",
    "write",
    "type",
    "typebox",
    "typeline",
    "read",
    "readnum",
    "readvoice",
    "readstr",
    "menu",
    "random",
    "hatch",
    "button",
    "img",
    "table",
    "rgb",
    "rgba",
    "hsl",
    "hsla",
    "click",
    "dblclick",
    "mouseup",
    "mousedown",
    "mousemove",
    "keydown",
    "keyup",
    "keypress",
    "send",
    "recv",
    "abs",
    "acos",
    "asin",
    "atan",
    "cos",
    "sin",
    "tan",
    "acosd",
    "asind",
    "atand",
    "cosd",
    "sind",
    "tand",
    "ceil",
    "floor",
    "round",
    "exp",
    "ln",
    "log10",
    "pow",
    "sqrt",
    "max",
    "min",
    "Pencil",
    "Turtle",
    "Piano",
    "Webcam",
    "Sprite",
    "loadscript",
    "pressed",
    "help",
    "defaultspeed",
    "none",
    "erase",
    "path",
    "up",
    "down",
    "color",
    "position",
    "normal",
    "touch",
    "aliceblue",
    "antiquewhite",
    "aqua",
    "aquamarine",
    "azure",
    "beige",
    "bisque",
    "black",
    "blanchedalmond",
    "blue",
    "blueviolet",
    "brown",
    "burlywood",
    "cadetblue",
    "chartreuse",
    "chocolate",
    "coral",
    "cornflowerblue",
    "cornsilk",
    "crimson",
    "cyan",
    "darkblue",
    "darkcyan",
    "darkgoldenrod",
    "darkgray",
    "darkgrey",
    "darkgreen",
    "darkkhaki",
    "darkmagenta",
    "darkolivegreen",
    "darkorange",
    "darkorchid",
    "darkred",
    "darksalmon",
    "darkseagreen",
    "darkslateblue",
    "darkslategray",
    "darkslategrey",
    "darkturquoise",
    "darkviolet",
    "deeppink",
    "deepskyblue",
    "dimgray",
    "dimgrey",
    "dodgerblue",
    "firebrick",
    "floralwhite",
    "forestgreen",
    "fuchsia",
    "gainsboro",
    "ghostwhite",
    "gold",
    "goldenrod",
    "gray",
    "grey",
    "green",
    "greenyellow",
    "honeydew",
    "hotpink",
    "indianred",
    "indigo",
    "ivory",
    "khaki",
    "lavender",
    "lavenderblush",
    "lawngreen",
    "lemonchiffon",
    "lightblue",
    "lightcoral",
    "lightcyan",
    "lightgoldenrodyellow",
    "lightgray",
    "lightgrey",
    "lightgreen",
    "lightpink",
    "lightsalmon",
    "lightseagreen",
    "lightskyblue",
    "lightslategray",
    "lightslategrey",
    "lightsteelblue",
    "lightyellow",
    "lime",
    "limegreen",
    "linen",
    "magenta",
    "maroon",
    "mediumaquamarine",
    "mediumblue",
    "mediumorchid",
    "mediumpurple",
    "mediumseagreen",
    "mediumslateblue",
    "mediumspringgreen",
    "mediumturquoise",
    "mediumvioletred",
    "midnightblue",
    "mintcream",
    "mistyrose",
    "moccasin",
    "navajowhite",
    "navy",
    "oldlace",
    "olive",
    "olivedrab",
    "orange",
    "orangered",
    "orchid",
    "palegoldenrod",
    "palegreen",
    "paleturquoise",
    "palevioletred",
    "papayawhip",
    "peachpuff",
    "peru",
    "pink",
    "plum",
    "powderblue",
    "purple",
    "rebeccapurple",
    "red",
    "rosybrown",
    "royalblue",
    "saddlebrown",
    "salmon",
    "sandybrown",
    "seagreen",
    "seashell",
    "sienna",
    "silver",
    "skyblue",
    "slateblue",
    "slategray",
    "slategrey",
    "snow",
    "springgreen",
    "steelblue",
    "teal",
    "thistle",
    "tomato",
    "turquoise",
    "violet",
    "wheat",
    "white",
    "whitesmoke",
    "yellow",
    "yellowgreen",
    "transparent",
    "PI",
    "E",
    "print",
    "rt",
    "lt",
    "fd",
    "bk",
    "slide",
    "move",
    "movexy",
    "moveto",
    "jump",
    "jumpxy",
    "jumpto",
    "turnto",
    "home",
    "pen",
    "fill",
    "dot",
    "box",
    "arrow",
    "mirror",
    "twist",
    "scale",
    "grow",
    "pause",
    "st",
    "ht",
    "pu",
    "pd",
    "pe",
    "pf",
    "imagedata",
    "clip",
    "wear",
    "saveimg",
    "drawon",
    "label",
    "reload",
    "pagexy",
    "getxy",
    "direction",
    "distance",
    "cell",
    "shown",
    "hidden",
    "inside",
    "touches",
    "within",
    "notwithin",
    "nearest",
    "plan",
    "direct",
    "enclosedby",
    "bearing",
    "css",
    "fadeIn",
    "fadeOut",
    "fadeTo",
    "fadeToggle",
    "animate",
    "show",
    "hide",
    "toggle",
    "finish",
    "promise"
  ];
  for (var j = 0; j < expected.length; ++j) {
    ok(window.hasOwnProperty(expected[j]), 'checking ' + expected[j]);
    delete window[expected[j]];
  }
  ok(_global_leaks_().length == 0, _global_leaks_());
  start();
});
</script>
